% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ctxtheta.R
\name{ctxthetaf}
\alias{ctxthetaf}
\title{Context-Aware Theta method forecast}
\usage{
ctxthetaf(
  y,
  h = if (frequency(y) > 1) 2 * frequency(y) else 10,
  level = 95,
  theta = 0.5,
  fit_func = lm,
  predict_func = predict,
  type_pi = c("gaussian", "block-bootstrap", "surrogate", "kde", "bootstrap", "fitdistr",
    "meboot"),
  nsim = 100L,
  block_size = 5,
  seed = 123L,
  B = NULL,
  x = y,
  ...
)
}
\arguments{
\item{y}{Time series (ts object or numeric vector)}

\item{h}{Forecast horizon (default: 2*frequency for seasonal, 10 for non-seasonal)}

\item{level}{Confidence level(s) for prediction intervals (default: 95)}

\item{theta}{Theta coefficient for drift weighting (default: 0.5, giving theta line = 2)
\itemize{
\item theta = 0: No drift (pure SES)
\item theta = 0.5: Classical Theta method (theta line = 2)
\item theta = 1: Full drift
\item theta > 1: Amplified drift
}}

\item{fit_func}{Model fitting function (default: lm)}

\item{predict_func}{Prediction function (default: predict)}

\item{type_pi}{Default is "gaussian", otherwise, uses sequential
split conformal prediction as in Moudiki, T. (2025)}

\item{nsim}{Number of simulations when \code{type_pi} is not
"gaussian"}

\item{block_size}{Size of block when \code{type_pi} is
"block-bootstrap"}

\item{seed}{Reproducibility seed}

\item{B}{Alias for \code{nsim}}

\item{x}{Deprecated, use y instead}

\item{...}{Additional arguments passed to fit_func}
}
\value{
An object of class \code{forecast}
}
\description{
Returns forecasts and prediction intervals for a context-aware theta method forecast.
}
\details{
The classical theta method of Assimakopoulos and Nikolopoulos (2000) is equivalent to
simple exponential smoothing with drift, using theta = 2. This implementation extends
the method by:
\enumerate{
\item Allowing flexible specification of theta parameter (default 0.5, which gives theta = 2)
\item Using machine learning models to capture non-linear drift patterns
\item Computing time-varying slopes via numerical differentiation
}
}
\examples{
# Classical theta-like behavior (theta = 0.5)
fit1 <- ctxthetaf(AirPassengers)
plot(fit1)

# No drift (theta = 0)
fit2 <- ctxthetaf(AirPassengers, theta = 0)
plot(fit2)

# Amplified drift (theta = 1)
fit3 <- ctxthetaf(AirPassengers, theta = 1)
plot(fit3)

# With Random Forest
fit4 <- ctxthetaf(AirPassengers, fit_func = randomForest::randomForest)
plot(fit4)

}
\references{
Hyndman, R.J., and Billah, B. (2003) Unmasking the Theta method.
\emph{International J. Forecasting}, \bold{19}, 287-290.

Moudiki, T. (2025). Conformal Predictive Simulations for Univariate Time Series.
\emph{Proceedings of Machine Learning Research}, \bold{266}, 1-2.
}
\seealso{
\code{\link[forecast:thetaf]{forecast::thetaf()}}, \code{\link[forecast:ses]{forecast::ses()}}
}
\author{
T. Moudiki (based on RJH)
}
\keyword{ts}
